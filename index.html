<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personal Portfolio</title>

  <link rel="shortcut icon" href="./assets/images/logo.ico" type="image/x-icon">
  <link rel="stylesheet" href="./assets/css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    /* --- 1. CUSTOM THIN SCROLLBAR --- */
    ::-webkit-scrollbar {
      width: 2px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #0f0f1e;
    }

    ::-webkit-scrollbar-thumb {
      background: #333; 
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #00d4aa;
    }

    /* --- 2. HERO SECTION STYLING --- */
    .hero-section {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 0;
      will-change: transform, opacity;
      padding: 0 5%;
    }

    .hero-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      max-width: 1200px;
      transition: transform 0.1s linear, opacity 0.1s linear;
      gap: 40px;
    }

    .hero-text-wrapper {
      flex: 1;
      text-align: left;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }

    .welcome-text {
      font-size: 0.85rem;
      color: #00d4aa;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }

    .hero-name {
      font-size: clamp(3rem, 5vw, 4.5rem);
      font-weight: 700;
      margin: 0 0 10px 0;
      color: white;
      line-height: 1.1;
    }

    .hero-title {
      font-size: 1.2rem;
      color: #888;
      margin: 0 0 20px 0;
      font-weight: 500;
    }

    .hero-description {
      font-size: 1rem;
      color: #bbb;
      margin: 0 0 30px 0;
      max-width: 500px;
      line-height: 1.6;
    }

    .expertise-label {
      font-size: 0.9rem;
      font-weight: 600;
      color: white;
      margin-bottom: 10px;
      display: block;
    }

    .hero-expertise {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 30px;
    }

    .expertise-tag {
      display: inline-block;
      background: rgba(0, 212, 170, 0.1);
      border: 1px solid #00d4aa;
      color: #00d4aa;
      padding: 5px 12px;
      border-radius: 15px;
      margin-right: 10px;
      margin-bottom: 5px;
      font-size: 0.85rem;
    }

    .hero-buttons {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
    }

    .hero-btn {
      padding: 12px 28px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      font-size: 0.95rem;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hero-btn.primary {
      background: #00d4aa;
      border: 1px solid #00d4aa;
      color: #1a1a2e;
    }
    .hero-btn.primary:hover {
      background: transparent;
      color: #00d4aa;
    }

    .hero-btn.outline {
      background: transparent;
      border: 1px solid #444;
      color: white;
    }
    .hero-btn.outline:hover {
      border-color: #00d4aa;
      color: #00d4aa;
    }

    .hero-socials {
      display: flex;
      gap: 20px;
    }

    .social-icon {
      font-size: 1.4rem;
      color: #888;
      cursor: pointer;
      transition: 0.3s;
      text-decoration: none;
    }
    .social-icon:hover {
      color: #00d4aa;
      transform: translateY(-3px);
    }

    .hero-avatar-box {
      flex: 0 0 350px;
      height: 350px;
      position: relative;
    }

    .hero-avatar-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 30px; 
      box-shadow: 20px 20px 0px rgba(0, 212, 170, 0.1);
      background: #222;
    }

    .scroll-indicator {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      color: #555;
      animation: bounce 2s infinite;
      font-size: 0.8rem;
    }

    @keyframes bounce {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(10px); }
    }

    @media (max-width: 1024px) {
      .hero-content {
        flex-direction: column-reverse;
        text-align: center;
      }
      .hero-text-wrapper {
        align-items: center;
        text-align: center;
      }
      .hero-avatar-box {
        flex: 0 0 250px;
        height: 250px;
        margin-bottom: 30px;
      }
    }

    /* --- CAROUSEL STYLES --- */
    .project-img {
      position: relative;
      overflow: hidden;
      border-radius: 15px;
      margin-bottom: 15px;
      height: 200px;
    }
    
    .carousel-track {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
      height: 100%;
      width: 100%;
      scrollbar-width: none;
    }
    .carousel-track::-webkit-scrollbar { display: none; }
    
    .carousel-track img {
      flex: 0 0 100%;
      width: 100%;
      height: 100%;
      object-fit: cover;
      scroll-snap-align: center;
    }

    /* Buttons have higher z-index to be clickable over the link overlay */
    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.6);
      color: #00d4aa;
      border: none;
      font-size: 1.5rem;
      padding: 5px 10px;
      cursor: pointer;
      z-index: 20; 
      border-radius: 5px;
      transition: 0.3s;
    }
    .carousel-btn:hover { background: #00d4aa; color: #fff; }
    .carousel-btn.prev { left: 10px; }
    .carousel-btn.next { right: 10px; }

    /* --- ACCORDION & LIST STYLES --- */
    
    .project-item {
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        position: relative; 
    }

    .project-desc-list {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.4s ease-out, opacity 0.4s ease-out, margin 0.4s ease;
        margin-bottom: 0;
        opacity: 0;
        color: #ccc;
        font-size: 0.85rem;
        line-height: 1.5;
        padding-left: 20px;
        list-style-type: decimal;
    }

    .project-desc-list.active {
        max-height: 500px; 
        opacity: 1;
        margin-bottom: 15px;
        margin-top: 10px;
    }

    .project-desc-list li {
        margin-bottom: 5px;
    }

    .details-toggle-btn {
        background: transparent;
        border: 1px solid #00d4aa;
        color: #00d4aa;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.8rem;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        transition: all 0.3s ease;
        margin-top: 10px;
        position: relative;
        z-index: 20; 
        align-self: flex-start; 
    }

    .details-toggle-btn:hover {
        background: rgba(0, 212, 170, 0.1);
        transform: translateY(-2px);
    }

    .details-toggle-btn ion-icon {
        transition: transform 0.3s;
    }

    .details-toggle-btn.active ion-icon {
        transform: rotate(180deg);
    }

    /* --- ORIGINAL STYLES PRESERVED --- */
    body {
      margin: 0;
      padding: 0;
      background: #0f0f1e;
    }

    .main-wrapper {
      position: relative;
      z-index: 10;
      background: #0f0f1e;
      margin-top: 100vh;
      box-shadow: 0 -20px 50px rgba(0,0,0,0.5);
      min-height: 100vh;
    }

    article {
      display: block !important;
      opacity: 1 !important;
      visibility: visible !important;
      transform: none !important;
      height: auto !important;
      margin-bottom: 30px !important;
      padding-bottom: 30px !important;
    }

    html {
      scroll-behavior: smooth;
    }

    main {
      display: flex;
      gap: 25px;
      align-items: flex-start;
      min-height: 100vh;
      max-width: 1600px; 
      margin: 0 auto;
      padding: 20px;
      width: 100%;
    }

    @media (min-width: 1024px) {
      .sidebar {
        position: sticky;
        top: 30px;
        z-index: 10;
        max-height: calc(100vh - 60px);
        overflow-y: auto;
        flex-shrink: 0;
        width: 25%;
      }
    }

    .main-content {
      flex: 1;
      min-width: 0;
    }

    .navbar {
      position: sticky;
      top: 0;
      z-index: 50;
      background: var(--bg-gradient-onyx);
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
      margin-bottom: 20px;
      box-shadow: 0 5px 10px hsla(0, 0%, 0%, 0.1);
    }

    .navbar-link {
      text-decoration: none;
      display: block;
      width: 100%;
      transition: color 0.3s ease;
    }
    
    .navbar-link.active {
      color: var(--orange-yellow-crayola) !important;
    }
    
    .navbar-link:hover, .navbar-link:focus {
      color: var(--orange-yellow-crayola);
    }

    @media (max-width: 1024px) {
      main {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        position: relative;
        top: 0;
        margin-bottom: 20px;
      }
      .main-content {
        width: 100%;
      }
      .navbar-list {
        display: flex;
        overflow-x: auto;
        white-space: nowrap;
        padding-bottom: 5px;
      }
      .navbar-list::-webkit-scrollbar {
        height: 4px;
      }
      .navbar-list::-webkit-scrollbar-thumb {
        background: #00d4aa; 
        border-radius: 4px;
      }
      .navbar-item {
        min-width: auto;
        padding: 0 15px;
      }
    }

    @media (max-width: 768px) {
      .hero-name { font-size: 2.5rem; }
      .hero-title { font-size: 1.2rem; }
      #certificationsList, #serviceList, .project-list {
        grid-template-columns: 1fr !important;
      }
    }
  </style>
</head>

<body>

<section class="hero-section" id="heroSection">
  <div class="hero-content" id="heroContent">
    <div class="hero-text-wrapper" id="heroTextWrapper">
        <p class="welcome-text" id="heroWelcomeText">WELCOME TO MY PORTFOLIO</p>
        <h1 class="hero-name" id="heroName">Loading...</h1>
        <p class="hero-title" id="heroTitle">Data Scientist & Digital Economist</p>
        <p class="hero-description" id="heroDescription">Loading portfolio data...</p>
        <span class="expertise-label">Expertise in:</span>
        <div class="hero-expertise" id="heroExpertise">
        <span class="expertise-tag">Hello </span>
        </div>
        <div class="hero-buttons" id="heroButtons">
          <button class="hero-btn primary" onclick="document.getElementById('contact').scrollIntoView({behavior: 'smooth'})">Get in Touch →</button>
          <button class="hero-btn outline" onclick="openGithub()">
             <ion-icon name="logo-github"></ion-icon> GitHub
          </button>
        </div>
        <div class="hero-socials" id="heroSocials">
        </div>
    </div>
    <div class="hero-avatar-box">
      <img id="heroAvatarImg" class="hero-avatar-img" src="./assets/images/my-avatar.png" alt="Avatar" onerror="this.src='https://placehold.co/400x400/222/FFF?text=Avatar'">
    </div>
    <div class="scroll-indicator">
      <p>Scroll to explore</p>
      <p style="font-size: 24px;">↓</p>
    </div>
  </div>
</section>

  <div class="main-wrapper">
    <main>

      <aside class="sidebar" data-sidebar>
        <div class="sidebar-info">
          <figure class="avatar-box">
            <img id="sidebarAvatar" src="" alt="Avatar" width="80">
          </figure>
          <div class="info-content">
            <h1 class="name" id="sidebarName" title=""></h1>
            <p class="title" id="sidebarTitle1"></p>
            <p class="title" id="sidebarTitle2"></p>
            <p class="title" id="sidebarTitle3">Data Analysis</p>
          </div>
          <button class="info_more-btn" data-sidebar-btn>
            <span>Show Contacts</span>
            <ion-icon name="chevron-down"></ion-icon>
          </button>
        </div>
        <div class="sidebar-info_more">
          <div class="separator"></div>
          <ul class="contacts-list" id="contactsList"></ul>
          <div class="separator"></div>
          <ul class="social-list" id="sidebarSocialList"></ul>
        </div>
      </aside>

      <div class="main-content">
        <nav class="navbar">
          <ul class="navbar-list" id="navbarList"></ul>
        </nav>

        <article class="about" id="about">
          <header><h2 class="h2 article-title">About me</h2></header>
          <section class="about-text" id="aboutText"></section>
          
          <section class="service" id="serviceSection">
            <h3 class="h3 service-title">What I'm Doing</h3>
            <ul class="service-list" id="serviceList"></ul>
          </section>
        </article>

        <article class="github" id="github">
          <header><h2 class="h2 article-title">Github Repositories</h2></header>
          <section class="projects">
            <ul class="project-list" id="github-repo-list">
                <li style="color: white; font-size: 14px;">Loading repositories...</li>
            </ul>
          </section>
        </article>

        <article class="resume" id="resume">
          <header><h2 class="h2 article-title">Resume</h2></header>
          <section class="timeline">
            <div class="title-wrapper">
              <div class="icon-box"><ion-icon name="book-outline"></ion-icon></div>
              <h3 class="h3">Education</h3>
            </div>
            <ol class="timeline-list" id="educationList"></ol>
          </section>
          <section class="skill">
            <h3 class="h3 skills-title">My skills</h3>
            <ul class="skills-list content-card" id="skillsList"></ul>
          </section>
        </article>

        <article class="experience" id="experience">
          <header><h2 class="h2 article-title">Experience</h2></header>
          <section class="timeline">
            <div class="title-wrapper">
              <div class="icon-box"><ion-icon name="briefcase-outline"></ion-icon></div>
              <h3 class="h3">Work Experience</h3>
            </div>
            <ol class="timeline-list" id="experienceList"></ol>
          </section>
        </article>

        <article class="certifications" id="certifications">
          <header><h2 class="h2 article-title">Certifications</h2></header>
          <section class="timeline">
            <div class="title-wrapper">
              <div class="icon-box"><ion-icon name="medal-outline"></ion-icon></div>
              <h3 class="h3">My Certificates</h3>
            </div>
            <ol class="timeline-list" id="certificationsList"></ol>
          </section>
        </article>

        <article class="portfolio" id="portfolio">
          <header><h2 class="h2 article-title">Portfolio</h2></header>
          <section class="projects">
            <ul class="filter-list" id="filterList"></ul>
            <ul class="project-list" id="projectList"></ul>
          </section>
        </article>

        <article class="blog" id="blog">
          <header><h2 class="h2 article-title">Blog</h2></header>
          <section class="blog-posts">
            <ul class="blog-posts-list" id="blogList"></ul>
          </section>
        </article>

        <article class="contact" id="contact">
          <header><h2 class="h2 article-title">Contact</h2></header>
          
          <section class="mapbox" data-mapbox style="display:none;">
            <figure><iframe id="contactMap" width="0" height="0" loading="lazy"></iframe></figure>
          </section>

          <section class="contact-form-wrapper">
            <h3 class="h3 form-title">Contact Information & Resume</h3>
            
            <div class="contact-info-grid" id="mainContactList" style="margin-bottom: 30px; display: grid; gap: 20px; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
            </div>

            <div class="cv-container" style="width: 100%; height: 600px; border-radius: 20px; overflow: hidden; border: 1px solid #333; background: #222;">
                <object id="cv-viewer" type="application/pdf" width="100%" height="100%" style="display:block;">
                    <div style="height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; color: #ccc;">
                        <ion-icon name="document-text-outline" style="font-size: 48px; color: #00d4aa; margin-bottom: 15px;"></ion-icon>
                        <p style="margin-bottom: 15px;">Unable to render PDF directly in this browser.</p>
                        <a id="cv-fallback-link" href="#" class="hero-btn primary" style="text-decoration: none; display: inline-flex;">
                            Download CV
                        </a>
                    </div>
                </object>
            </div>
          </section>
        </article>
      </div>
    </main>
  </div>

  <script type="module" src="https://unpkg.com/ionicons@7/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7/dist/ionicons/ionicons.js"></script>
  <script>
    window.portfolioData = {};

    function openGithub() {
        if(window.portfolioData && window.portfolioData.github) {
            window.open('https://github.com/' + window.portfolioData.github.username, '_blank');
        }
    }
    
    // Helper Function for Carousel Sliding
    window.scrollCarousel = function(id, direction) {
        const track = document.getElementById(id);
        if(track) {
            const scrollAmount = track.clientWidth;
            if (direction === 1) {
                track.scrollLeft += scrollAmount;
            } else {
                track.scrollLeft -= scrollAmount;
            }
        }
    };

    // Helper: Toggle Description Visibility
    window.toggleDetails = function(id, btn) {
        const desc = document.getElementById(id);
        if(desc) {
            desc.classList.toggle('active');
            btn.classList.toggle('active');
            
            // Update Text based on state
            const textSpan = btn.querySelector('span');
            if(desc.classList.contains('active')) {
                textSpan.textContent = "Hide Findings";
            } else {
                textSpan.textContent = "View Key Findings";
            }
        }
    };

    async function loadPortfolioData() {
      try {
        const response = await fetch('./data.json');
        if (!response.ok) throw new Error('Failed to load data.json');
        const data = await response.json();
        window.portfolioData = data;
        populateWebsite(data);
      } catch (error) {
        console.error('Error loading portfolio data:', error);
        document.getElementById('heroName').textContent = "Error Loading Data";
      }
    }

    function populateWebsite(data) {
      // HERO
      document.getElementById('heroAvatarImg').src = data.personal.avatar;
      document.getElementById('heroName').textContent = data.personal.name;
      document.getElementById('heroTitle').textContent = data.personal.title.join(' & ');
      document.getElementById('heroDescription').textContent = data.about.description[0];
      if(data.about.welcomeText) document.getElementById('heroWelcomeText').textContent = data.about.welcomeText;

      const heroExpertise = document.getElementById('heroExpertise');
      heroExpertise.innerHTML = '';
      
      // HERO TAGS NOW USE data.about.expertise
      if(data.about.expertise) {
          data.about.expertise.forEach(item => {
            const tag = document.createElement('div');
            tag.className = 'expertise-tag';
            tag.textContent = item;
            heroExpertise.appendChild(tag);
          });
      }

      const heroSocials = document.getElementById('heroSocials');
      heroSocials.innerHTML = '';
      
      const fullSocialMap = { 
          'facebook': 'logo-facebook', 
          'twitter': 'logo-twitter', 
          'instagram': 'logo-instagram', 
          'linkedin': 'logo-linkedin', 
          'github': 'logo-github', 
          'website': 'globe-outline' 
      };

      if(data.personal.social) {
          for (const [key, url] of Object.entries(data.personal.social)) {
              if(url && url !== '#') {
                  const socialIcon = document.createElement('a');
                  socialIcon.href = url;
                  socialIcon.target = "_blank";
                  socialIcon.className = 'social-icon';
                  socialIcon.innerHTML = `<ion-icon name="${fullSocialMap[key] || 'link-outline'}"></ion-icon>`;
                  heroSocials.appendChild(socialIcon);
              }
          }
      }

      // SIDEBAR
      document.getElementById('sidebarAvatar').src = data.personal.avatar;
      document.getElementById('sidebarName').textContent = data.personal.name;
      document.getElementById('sidebarName').title = data.personal.name;
      document.getElementById('sidebarTitle1').textContent = data.personal.title[0];
      if (data.personal.title[1]) document.getElementById('sidebarTitle2').textContent = data.personal.title[1];
      if (data.personal.title[2]) document.getElementById('sidebarTitle3').textContent = data.personal.title[2];

      const contactsList = document.getElementById('contactsList');
      contactsList.innerHTML = '';
      const contacts = [
        { title: 'Email', value: data.personal.email, icon: 'mail-outline', type: 'email' },
        { title: 'Phone', value: data.personal.phone, icon: 'phone-portrait-outline', type: 'phone' },
        { title: 'Location', value: data.personal.location, icon: 'location-outline', type: 'address' }
      ];
      contacts.forEach(contact => {
        const li = document.createElement('li');
        li.className = 'contact-item';
        li.innerHTML = `
          <div class="icon-box"><ion-icon name="${contact.icon}"></ion-icon></div>
          <div class="contact-info">
            <p class="contact-title">${contact.title}</p>
            ${contact.type === 'email' ? `<a href="mailto:${contact.value}" class="contact-link">${contact.value}</a>` :
              contact.type === 'phone' ? `<a href="tel:${contact.value}" class="contact-link">${contact.value}</a>` :
              contact.type === 'date' ? `<time datetime="${contact.value}">${new Date(contact.value).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</time>` :
              `<address>${contact.value}</address>`}
          </div>
        `;
        contactsList.appendChild(li);
      });

      // SIDEBAR SOCIALS
      const sidebarSocialList = document.getElementById('sidebarSocialList');
      sidebarSocialList.innerHTML = '';
      if(data.personal.social) {
          for (const [key, url] of Object.entries(data.personal.social)) {
              if(url && url !== '#') {
                 const li = document.createElement('li');
                 li.className = 'social-item';
                 li.innerHTML = `<a href="${url}" class="social-link" target="_blank"><ion-icon name="${fullSocialMap[key] || 'link-outline'}"></ion-icon></a>`;
                 sidebarSocialList.appendChild(li);
              }
          }
      }

      // NAVBAR
      const navbarList = document.getElementById('navbarList');
      navbarList.innerHTML = '';
      const sections = ['about', 'github', 'resume', 'experience', 'certifications', 'portfolio', 'blog', 'contact'];
      sections.forEach(section => {
        const li = document.createElement('li');
        li.className = 'navbar-item';
        li.innerHTML = `<a href="#${section}" class="navbar-link">${section.charAt(0).toUpperCase() + section.slice(1)}</a>`;
        navbarList.appendChild(li);
      });

      // ABOUT
      const aboutText = document.getElementById('aboutText');
      aboutText.innerHTML = '';
      data.about.description.forEach(desc => {
        const p = document.createElement('p');
        p.textContent = desc;
        aboutText.appendChild(p);
      });

      // SERVICES (Now populated from data.about.services, back inside About)
      const serviceList = document.getElementById('serviceList');
      serviceList.innerHTML = '';
      if(data.about.services) {
          data.about.services.forEach(service => {
            const li = document.createElement('li');
            li.className = 'service-item';
            li.innerHTML = `
              <div class="service-icon-box"><img src="${service.icon}" alt="${service.title} icon" width="40" onerror="this.src='./assets/images/icon-design.svg'"></div>
              <div class="service-content-box">
                <h4 class="h4 service-item-title">${service.title}</h4>
                <p class="service-item-text">${service.description}</p>
              </div>
            `;
            serviceList.appendChild(li);
          });
      }

      // RESUME: Education
      const educationList = document.getElementById('educationList');
      educationList.innerHTML = '';
      data.resume.education.forEach(edu => {
        const li = document.createElement('li');
        li.className = 'timeline-item';
        li.innerHTML = `
          <h4 class="h4 timeline-item-title" style="display: flex; align-items: center; gap: 10px;">
            <ion-icon name="book-outline"></ion-icon> ${edu.degree}
          </h4>
          <h5 class="h4 timeline-item-title" style="display: flex; align-items: center; gap: 10px; font-size: 15px; font-weight: normal; margin-top: 5px;">
            <ion-icon name="business-outline"></ion-icon> ${edu.institution}
          </h5>
          <span style="display: flex; align-items: center; gap: 10px; margin-top: 10px; color: #ffdb70;">
            <ion-icon name="time-outline"></ion-icon> ${edu.period}
          </span>
          <p class="timeline-text" style="margin-top: 10px;">${edu.description}</p>
        `;
        educationList.appendChild(li);
      });

      // RESUME: Skills
      const skillsList = document.getElementById('skillsList');
      skillsList.innerHTML = '';
      data.resume.skills.forEach(skill => {
        const li = document.createElement('li');
        li.className = 'skills-item';
        li.innerHTML = `
          <div class="title-wrapper"><h5 class="h5">${skill.name}</h5><data value="${skill.percentage}">${skill.percentage}%</data></div>
          <div class="skill-progress-bg"><div class="skill-progress-fill" style="width: ${skill.percentage}%;"></div></div>
        `;
        skillsList.appendChild(li);
      });

      // EXPERIENCE
      const experienceList = document.getElementById('experienceList');
      experienceList.innerHTML = '';
      data.experience.forEach(exp => {
        const li = document.createElement('li');
        li.className = 'timeline-item';
        const descriptionHtml = exp.description.map(desc => `<li style="margin-left: 20px; margin-bottom: 8px;">${desc}</li>`).join('');
        const skillsHtml = exp.skills.map(skill => `<span style="display: inline-block; background: rgba(0, 212, 170, 0.1); border: 1px solid #00d4aa; color: #00d4aa; padding: 5px 12px; border-radius: 15px; margin-right: 10px; margin-bottom: 8px; font-size: 0.85rem;">${skill}</span>`).join('');
        li.innerHTML = `
          <h4 class="h4 timeline-item-title" style="display: flex; align-items: center; gap: 10px;">
            <ion-icon name="briefcase-outline"></ion-icon> ${exp.position}
          </h4>
          <h5 class="h4 timeline-item-title" style="display: flex; align-items: center; gap: 10px; font-size: 15px; font-weight: normal; margin-top: 5px;">
            <ion-icon name="business-outline"></ion-icon> ${exp.company}
          </h5>
          <span style="display: flex; align-items: center; gap: 10px; margin-top: 10px; color: #ffdb70;">
            <ion-icon name="location-outline"></ion-icon> ${exp.location}
          </span>
          <span style="display: flex; align-items: center; gap: 10px; margin-top: 10px; color: #aaa;">
            <ion-icon name="time-outline"></ion-icon> ${exp.period}
          </span>
          <ul style="margin-top: 15px; padding: 0; list-style: none; color:White ">
            ${descriptionHtml}
          </ul>
          <div style="margin-top: 15px;">
            <p style="color: #ffdb70; font-size: 0.9rem; font-weight: 600; margin-bottom: 10px;">Skills:</p>
            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
              ${skillsHtml}
            </div>
          </div>
        `;
        experienceList.appendChild(li);
      });

      // CERTIFICATIONS
      const certificationsList = document.getElementById('certificationsList');
      certificationsList.innerHTML = '';
      certificationsList.style.display = 'grid';
      certificationsList.style.gridTemplateColumns = 'repeat(auto-fit, minmax(300px, 1fr))';
      certificationsList.style.gap = '30px';
      certificationsList.style.listStyle = 'none';
      certificationsList.style.padding = '0';
      
      data.certifications.forEach(cert => {
        const li = document.createElement('li');
        li.className = 'cert-grid-item';
        li.style.cssText = `
          background: linear-gradient(135deg, rgba(0, 212, 170, 0.1) 0%, rgba(255, 219, 112, 0.1) 100%);
          border: 1px solid rgba(0, 212, 170, 0.3);
          border-radius: 20px;
          padding: 20px;
          transition: all 0.3s ease;
          cursor: pointer;
        `;
        li.onmouseover = () => { li.style.transform = 'translateY(-5px)'; li.style.boxShadow = '0 10px 30px rgba(0, 212, 170, 0.2)'; };
        li.onmouseout = () => { li.style.transform = 'translateY(0)'; li.style.boxShadow = 'none'; };
        li.innerHTML = `
          <img src="${cert.image}" alt="${cert.title}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: 15px;" onerror="this.src='./assets/images/project-1.jpg'">
          <h4 class="h4 timeline-item-title" style="color: #fff; margin-bottom: 10px;">${cert.title}</h4>
          <h5 style="color: #aaa; font-size: 0.9rem; margin-bottom: 10px;">${cert.issuer}</h5>
          <span style="color: #ffdb70; font-size: 0.85rem; display: block; margin-bottom: 15px;">${cert.year}</span>
          <p style="color: #ccc; font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">${cert.description}</p>
          <a href="${cert.link}" target="_blank" style="display: inline-block; background: #00d4aa; color: #1a1a2e; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.3s ease;" onmouseover="this.style.background='#00b89f'" onmouseout="this.style.background='#00d4aa'">Verify Certificate</a>
        `;
        certificationsList.appendChild(li);
      });

      // --- PORTFOLIO (Accordion + Fixed Links) ---
      const filterList = document.getElementById('filterList');
      const projectList = document.getElementById('projectList');
      filterList.innerHTML = '';
      projectList.innerHTML = '';
      
      data.portfolio.filters.forEach((filter, index) => {
        const li = document.createElement('li');
        li.className = 'filter-item';
        const btn = document.createElement('button');
        btn.className = `filter-btn ${index === 0 ? 'active' : ''}`;
        btn.setAttribute('data-filter-btn', '');
        btn.textContent = filter;
        
        btn.onclick = (e) => {
          document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          const category = filter === 'All' ? '' : filter;
          
          document.querySelectorAll('.project-item').forEach(item => {
            const itemCats = item.getAttribute('data-category').split(',');
            if (category === '' || itemCats.includes(category)) {
              item.style.display = 'block';
            } else {
              item.style.display = 'none';
            }
          });
        };
        li.appendChild(btn);
        filterList.appendChild(li);
      });

      data.portfolio.projects.forEach((project, index) => {
        const li = document.createElement('li');
        li.className = 'project-item active';
        li.setAttribute('data-filter-item', '');
        
        // Handle category array -> string for filtering
        let catStr = Array.isArray(project.category) ? project.category.join(',') : project.category;
        li.setAttribute('data-category', catStr);

        // Unique IDs
        const carouselId = `carousel-${index}`;
        const descId = `desc-${index}`;

        // Carousel Setup
        let imagesHtml = '';
        if (project.images && project.images.length > 0) {
            project.images.forEach(img => {
                imagesHtml += `<img src="${img}" alt="${project.title}" loading="lazy" onerror="this.src='./assets/images/project-1.jpg'">`;
            });
        } else {
            const imgSource = project.image || './assets/images/project-1.jpg';
            imagesHtml = `<img src="${imgSource}" alt="${project.title}" loading="lazy">`;
        }

        // Description List Setup (Hidden initially)
        let descHtml = '';
        if (project.description && Array.isArray(project.description)) {
            descHtml = `<ol id="${descId}" class="project-desc-list">` + 
                       project.description.map(d => `<li>${d}</li>`).join('') + 
                       `</ol>`;
        } else if (project.description) {
            descHtml = `<p id="${descId}" class="project-desc-list" style="list-style:none; padding-left:0;">${project.description}</p>`;
        }

        // Display Category
        const displayCategory = Array.isArray(project.category) ? project.category.join(', ') : project.category;

        li.innerHTML = `
          <figure class="project-img">
             <a href="${project.link}" target="_blank" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; cursor: pointer;"></a>

             ${project.images && project.images.length > 1 ? `
               <button class="carousel-btn prev" onclick="scrollCarousel('${carouselId}', -1)">❮</button>
               <button class="carousel-btn next" onclick="scrollCarousel('${carouselId}', 1)">❯</button>
             ` : ''}
             <div class="carousel-track" id="${carouselId}">
               ${imagesHtml}
             </div>
          </figure>

          <a href="${project.link}" target="_blank" style="text-decoration:none; display:block; position:relative; z-index:5;">
             <h3 class="project-title">${project.title}</h3>
          </a>
          
          <p class="project-category">${displayCategory}</p>
          
          <button class="details-toggle-btn" onclick="toggleDetails('${descId}', this)">
             <span>View Key Findings</span>
             <ion-icon name="chevron-down-outline"></ion-icon>
          </button>

          ${descHtml}
        `;
        projectList.appendChild(li);
      });

      // BLOG
      const blogList = document.getElementById('blogList');
      blogList.innerHTML = '';
      data.blog.forEach(post => {
        const li = document.createElement('li');
        li.className = 'blog-post-item';
        const date = new Date(post.date);
        const formattedDate = date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        li.innerHTML = `
          <a href="${post.link}">
            <figure class="blog-banner-box">
              <img src="${post.image}" alt="${post.title}" loading="lazy" onerror="this.src='./assets/images/blog-1.jpg'">
            </figure>
            <div class="blog-content">
              <div class="blog-meta">
                <p class="blog-category">${post.category}</p>
                <span class="dot"></span>
                <time datetime="${post.date}">${formattedDate}</time>
              </div>
              <h3 class="h3 blog-item-title">${post.title}</h3>
              <p class="blog-text">${post.description}</p>
            </div>
          </a>
        `;
        blogList.appendChild(li);
      });

      // Contact Info Grid
      const mainContactList = document.getElementById('mainContactList');
      if(mainContactList) {
          mainContactList.innerHTML = '';
          const mainContacts = [
             { title: 'Email', value: data.personal.email, icon: 'mail-outline', link: `mailto:${data.personal.email}` },
             { title: 'Phone', value: data.personal.phone, icon: 'phone-portrait-outline', link: `tel:${data.personal.phone}` },
             { title: 'Location', value: data.personal.location, icon: 'location-outline', link: null }
          ];
          
          mainContacts.forEach(item => {
             const div = document.createElement('div');
             div.style.cssText = `background: rgba(30,30,40,0.5); padding: 20px; border-radius: 12px; border: 1px solid #333; display: flex; align-items: center; gap: 15px; transition: 0.3s;`;
             div.onmouseover = () => { div.style.borderColor = '#00d4aa'; div.style.transform = 'translateY(-2px)'; }
             div.onmouseout = () => { div.style.borderColor = '#333'; div.style.transform = 'translateY(0)'; }

             div.innerHTML = `
                <div style="color: #00d4aa; font-size: 24px; display: flex;"><ion-icon name="${item.icon}"></ion-icon></div>
                <div style="overflow: hidden;">
                    <p style="color: #888; font-size: 11px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px;">${item.title}</p>
                    ${item.link ? 
                      `<a href="${item.link}" style="color: #fff; text-decoration: none; font-size: 14px; font-weight: 500; word-break: break-all;">${item.value}</a>` : 
                      `<p style="color: #fff; font-size: 14px; font-weight: 500; margin: 0;">${item.value}</p>`
                    }
                </div>
             `;
             mainContactList.appendChild(div);
          });
      }

      // Contact PDF Viewer
      const cvViewer = document.getElementById('cv-viewer');
      const cvFallback = document.getElementById('cv-fallback-link');
      const resumeUrl = data.contact.resumePdf || data.resumePdf || 'https://github.com/sanuzthapa/testwebp.github.io/blob/main/assets/documents/resume_sanuz_DS.pdf';
      if(cvViewer) cvViewer.setAttribute('data', resumeUrl);
      if(cvFallback) cvFallback.setAttribute('href', resumeUrl);


      // GITHUB FETCH
      if (data.github && data.github.username) {
        fetchGitHubRepos(data.github.username);
      } else {
        document.getElementById('github-repo-list').innerHTML = '<li style="color:#aaa;">GitHub username not found in data.json</li>';
      }
    }

    async function fetchGitHubRepos(username) {
      const repoList = document.getElementById('github-repo-list');
      
      repoList.style.display = 'grid';
      repoList.style.gridTemplateColumns = 'repeat(auto-fit, minmax(220px, 1fr))'; 
      repoList.style.gap = '20px';

      try {
        const response = await fetch(`https://api.github.com/users/${username}/repos?sort=updated&per_page=100`);
        if (!response.ok) throw new Error(`GitHub API Error: ${response.statusText}`);
        const repos = await response.json();
        
        if(repos.length === 0) {
             repoList.innerHTML = '<li style="color:#aaa;">No public repositories found.</li>';
             return;
        }

        repoList.innerHTML = '';

        if (!document.getElementById('github-custom-styles')) {
            const style = document.createElement('style');
            style.id = 'github-custom-styles';
            style.innerHTML = `
                .github-repo-card {
                    background: rgba(30, 30, 40, 0.5);
                    border: 1px solid #333;
                    border-radius: 12px;
                    padding: 15px; 
                    transition: all 0.25s ease;
                    display: flex;
                    flex-direction: column;
                    min-height: 140px;
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                    overflow: hidden; 
                    position: relative;
                    box-sizing: border-box;
                }
                .github-repo-card:hover {
                    border-color: #00d4aa;
                    transform: translateY(-5px);
                    background: rgba(30, 30, 40, 0.95);
                    z-index: 2;
                }
                .repo-desc {
                    color: #d6d6d6;
                    font-size: 0.75rem;
                    line-height: 1.5;
                    margin-bottom: 10px;
                    flex-grow: 1;
                    display: -webkit-box;
                    -webkit-line-clamp: 2;
                    -webkit-box-orient: vertical;
                    overflow: hidden;
                }
                .github-repo-card:hover .repo-desc {
                    -webkit-line-clamp: unset; 
                    overflow: visible;
                }
                .repo-title {
                    color: #fff;
                    font-size: 0.9rem;
                    font-weight: 600;
                    margin: 0;
                    text-transform: capitalize;
                    word-break: break-word;
                }
            `;
            document.head.appendChild(style);
        }

        repos.forEach(repo => {
          const li = document.createElement('li');
          li.className = 'github-repo-card';
          
          li.innerHTML = `
            <a href="${repo.html_url}" target="_blank" style="text-decoration: none; color: inherit; display: flex; flex-direction: column; height: 100%; width: 100%;">
              
              <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom: 8px;">
                  <h3 class="repo-title">
                     ${repo.name.replace(/-/g, ' ')}
                  </h3>
                  <div style="color:#00d4aa; font-size:1rem; flex-shrink: 0; margin-left: 5px;">
                    <ion-icon name="logo-github"></ion-icon>
                  </div>
              </div>

              <p style="color: #00d4aa; font-size: 0.7rem; margin-bottom: 8px; font-weight: 500;">
                 ${repo.language || 'Development'}
              </p>

              <div class="repo-desc">
                 ${repo.description || 'No description provided.'}
              </div>
              
              <div style="margin-top: auto; padding-top: 10px; border-top: 1px solid #333; color: #888; font-size: 0.7rem;">
                  <span style="margin-right: 15px; display:inline-flex; align-items:center; gap:4px;">
                    <ion-icon name="star-outline"></ion-icon> ${repo.stargazers_count}
                  </span>
                  <span style="display:inline-flex; align-items:center; gap:4px;">
                    <ion-icon name="git-network-outline"></ion-icon> ${repo.forks_count}
                  </span>
              </div>
            </a>
          `;
          repoList.appendChild(li);
        });
      } catch (error) {
        console.error('Error fetching GitHub repos:', error);
        repoList.innerHTML = `<li style="color: #ff6b6b; font-size: 14px;">Unable to load repositories. (${error.message})</li>`;
      }
    }

    function initScrollAnimation() {
      const heroContent = document.getElementById('heroContent');
      window.addEventListener('scroll', () => {
        const scrollY = window.scrollY;
        const windowHeight = window.innerHeight;
        const progress = Math.min(1, Math.max(0, scrollY / windowHeight));
        if (progress <= 1) {
            const opacity = 1 - progress; 
            const scale = 1 - (progress * 0.2); 
            const translateY = scrollY * 0.5;
            heroContent.style.opacity = opacity;
            heroContent.style.transform = `translateY(-${translateY}px) scale(${scale})`;
        } 
      }, { passive: true });
    }

    function updateActiveNavLink() {
      const sections = document.querySelectorAll('article');
      const navLinks = document.querySelectorAll('.navbar-link');
      window.addEventListener('scroll', () => {
        let current = '';
        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          if (window.scrollY >= sectionTop - 150) {
            current = section.getAttribute('id');
          }
        });
        navLinks.forEach(link => {
          link.classList.remove('active');
          if (link.getAttribute('href').slice(1) === current) {
            link.classList.add('active');
          }
        });
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
      loadPortfolioData();
      setTimeout(() => {
        initScrollAnimation();
        updateActiveNavLink();
        if (window.ionicons) {
          ionicons.build();
        }
      }, 100);
    });

    const observer = new MutationObserver(() => {
      if (window.ionicons) {
        ionicons.build();
      }
    });
    observer.observe(document.body, { childList: true, subtree: true });
  </script>
</body>
</html>
